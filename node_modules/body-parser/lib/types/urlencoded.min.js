function urlencoded(a){function b(a){return a.length?h(a):{}}a=a||{},void 0===a.extended&&deprecate("undefined extended: provide extended option");var c=a.extended!==!1,d=a.inflate!==!1,e="number"!=typeof a.limit?bytes(a.limit||"100kb"):a.limit,f=a.type||"urlencoded",g=a.verify||!1;if(g!==!1&&"function"!=typeof g)throw new TypeError("option verify must be function");var h=c?extendedparser(a):simpleparser(a),i="function"!=typeof f?typeChecker(f):f;return function(a,c,f){if(a._body)return debug("body already parsed"),f();if(a.body=a.body||{},!typeis.hasBody(a))return debug("skip empty body"),f();if(debug("content-type %j",a.headers["content-type"]),!i(a))return debug("skip parsing"),f();var h=getCharset(a)||"utf-8";if("utf-8"!==h){var j=new Error('unsupported charset "'+h.toUpperCase()+'"');return j.charset=h,j.status=415,debug("invalid charset"),f(j)}read(a,c,f,b,debug,{debug:debug,encoding:h,inflate:d,limit:e,verify:g})}}function extendedparser(a){var b=void 0!==a.parameterLimit?a.parameterLimit:1e3,c=parser("qs");if(isNaN(b)||1>b)throw new TypeError("option parameterLimit must be a positive number");return isFinite(b)&&(b=0|b),function(a){var d=parameterCount(a,b);if(void 0===d){var e=new Error("too many parameters");throw e.status=413,debug("too many parameters"),e}var f=Math.max(100,d);return debug("parse extended urlencoding"),c(a,{arrayLimit:f,depth:1/0,parameterLimit:b})}}function getCharset(a){try{return contentType.parse(a).parameters.charset.toLowerCase()}catch(b){return void 0}}function parameterCount(a,b){for(var c=0,d=0;-1!==(d=a.indexOf("&",d));)if(c++,d++,c===b)return void 0;return c}function parser(a){var b=parsers[a];return b?b.parse:(b=parsers[a]=require(a),b.parse)}function simpleparser(a){var b=void 0!==a.parameterLimit?a.parameterLimit:1e3,c=parser("querystring");if(isNaN(b)||1>b)throw new TypeError("option parameterLimit must be a positive number");return isFinite(b)&&(b=0|b),function(a){var d=parameterCount(a,b);if(void 0===d){var e=new Error("too many parameters");throw e.status=413,debug("too many parameters"),e}return debug("parse urlencoding"),c(a,void 0,void 0,{maxKeys:b})}}function typeChecker(a){return function(b){return Boolean(typeis(b,a))}}var bytes=require("bytes"),contentType=require("content-type"),debug=require("debug")("body-parser:urlencoded"),deprecate=require("depd")("body-parser"),read=require("../read"),typeis=require("type-is");module.exports=urlencoded;var parsers=Object.create(null);