function IconvLiteEncoderStream(a,b){this.conv=a,b=b||{},b.decodeStrings=!1,Transform.call(this,b)}function IconvLiteDecoderStream(a,b){this.conv=a,b=b||{},b.encoding=this.encoding="utf8",Transform.call(this,b)}var Transform=require("stream").Transform;module.exports=function(a){a.encodeStream=function(b,c){return new IconvLiteEncoderStream(a.getCodec(b).encoder(c),c)},a.decodeStream=function(b,c){return new IconvLiteDecoderStream(a.getCodec(b).decoder(c),c)},a.supportsStreams=!0,a.IconvLiteEncoderStream=IconvLiteEncoderStream,a.IconvLiteDecoderStream=IconvLiteDecoderStream,a._collect=IconvLiteDecoderStream.prototype.collect},IconvLiteEncoderStream.prototype=Object.create(Transform.prototype,{constructor:{value:IconvLiteEncoderStream}}),IconvLiteEncoderStream.prototype._transform=function(a,b,c){if("string"!=typeof a)return c(new Error("Iconv encoding stream needs strings as its input."));try{var d=this.conv.write(a);d&&d.length&&this.push(d),c()}catch(e){c(e)}},IconvLiteEncoderStream.prototype._flush=function(a){try{var b=this.conv.end();b&&b.length&&this.push(b),a()}catch(c){a(c)}},IconvLiteEncoderStream.prototype.collect=function(a){var b=[];return this.on("error",a),this.on("data",function(a){b.push(a)}),this.on("end",function(){a(null,Buffer.concat(b))}),this},IconvLiteDecoderStream.prototype=Object.create(Transform.prototype,{constructor:{value:IconvLiteDecoderStream}}),IconvLiteDecoderStream.prototype._transform=function(a,b,c){if(!Buffer.isBuffer(a))return c(new Error("Iconv decoding stream needs buffers as its input."));try{var d=this.conv.write(a);d&&d.length&&this.push(d,this.encoding),c()}catch(e){c(e)}},IconvLiteDecoderStream.prototype._flush=function(a){try{var b=this.conv.end();b&&b.length&&this.push(b,this.encoding),a()}catch(c){a(c)}},IconvLiteDecoderStream.prototype.collect=function(a){var b="";return this.on("error",a),this.on("data",function(a){b+=a}),this.on("end",function(){a(null,b)}),this};