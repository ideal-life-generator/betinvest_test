function acceptParams(a,b){for(var c=a.split(/ *; */),d={value:c[0],quality:1,params:{},originalIndex:b},e=1;e<c.length;++e){var f=c[e].split(/ *= */);"q"==f[0]?d.quality=parseFloat(f[1]):d.params[f[0]]=f[1]}return d}function newObject(){return{}}var contentDisposition=require("content-disposition"),contentType=require("content-type"),deprecate=require("depd")("express"),mime=require("send").mime,basename=require("path").basename,etag=require("etag"),proxyaddr=require("proxy-addr"),qs=require("qs"),querystring=require("querystring");exports.etag=function(a,b){var c=Buffer.isBuffer(a)?a:new Buffer(a,b);return etag(c,{weak:!1})},exports.wetag=function(a,b){var c=Buffer.isBuffer(a)?a:new Buffer(a,b);return etag(c,{weak:!0})},exports.isAbsolute=function(a){return"/"==a[0]?!0:":"==a[1]&&"\\"==a[2]?!0:"\\\\"==a.substring(0,2)?!0:void 0},exports.flatten=function(a,b){b=b||[];for(var c=a.length,d=0;c>d;++d)Array.isArray(a[d])?exports.flatten(a[d],b):b.push(a[d]);return b},exports.normalizeType=function(a){return~a.indexOf("/")?acceptParams(a):{value:mime.lookup(a),params:{}}},exports.normalizeTypes=function(a){for(var b=[],c=0;c<a.length;++c)b.push(exports.normalizeType(a[c]));return b},exports.contentDisposition=deprecate["function"](contentDisposition,"utils.contentDisposition: use content-disposition npm module instead"),exports.compileETag=function(a){var b;if("function"==typeof a)return a;switch(a){case!0:b=exports.wetag;break;case!1:break;case"strong":b=exports.etag;break;case"weak":b=exports.wetag;break;default:throw new TypeError("unknown value for etag function: "+a)}return b},exports.compileQueryParser=function(a){var b;if("function"==typeof a)return a;switch(a){case!0:b=querystring.parse;break;case!1:b=newObject;break;case"extended":b=qs.parse;break;case"simple":b=querystring.parse;break;default:throw new TypeError("unknown value for query parser function: "+a)}return b},exports.compileTrust=function(a){return"function"==typeof a?a:a===!0?function(){return!0}:"number"==typeof a?function(b,c){return a>c}:("string"==typeof a&&(a=a.split(/ *, */)),proxyaddr.compile(a||[]))},exports.setCharset=function(a,b){if(!a||!b)return a;var c=contentType.parse(a);return c.parameters.charset=b,contentType.format(c)};