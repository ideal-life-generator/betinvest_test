function contentDisposition(a,b){var c=b||{},d=c.type||"attachment",e=createparams(a,c.fallback);return format(new ContentDisposition(d,e))}function createparams(a,b){if(void 0!==a){var c={};if("string"!=typeof a)throw new TypeError("filename must be a string");if(void 0===b&&(b=!0),"string"!=typeof b&&"boolean"!=typeof b)throw new TypeError("fallback must be a string or boolean");if("string"==typeof b&&nonLatin1RegExp.test(b))throw new TypeError("fallback must be ISO-8859-1 string");var d=basename(a),e=textRegExp.test(d),f="string"!=typeof b?b&&getlatin1(d):basename(b),g="string"==typeof f&&f!==d;return(g||!e||hexEscapeRegExp.test(d))&&(c["filename*"]=d),(e||g)&&(c.filename=g?f:d),c}}function format(a){var b=a.parameters,c=a.type;if(!c||"string"!=typeof c||!tokenRegExp.test(c))throw new TypeError("invalid type");var d=String(c).toLowerCase();if(b&&"object"==typeof b)for(var e,f=Object.keys(b).sort(),g=0;g<f.length;g++){e=f[g];var h="*"===e.substr(-1)?ustring(b[e]):qstring(b[e]);d+="; "+e+"="+h}return d}function decodefield(a){var b=extValueRegExp.exec(a);if(!b)throw new TypeError("invalid extended field value");var c,d=b[1].toLowerCase(),e=b[2],f=e.replace(hexEscapeReplaceRegExp,pdecode);switch(d){case"iso-8859-1":c=getlatin1(f);break;case"utf-8":c=new Buffer(f,"binary").toString("utf8");break;default:throw new TypeError("unsupported charset in extended field")}return c}function getlatin1(a){return String(a).replace(nonLatin1RegExp,"?")}function parse(a){if(!a||"string"!=typeof a)throw new TypeError("argument string is required");var b=dispositionTypeRegExp.exec(a);if(!b)throw new TypeError("invalid type format");var c,d,e=b[0].length,f=b[1].toLowerCase(),g=[],h={};for(e=paramRegExp.lastIndex=";"===b[0].substr(-1)?e-1:e;b=paramRegExp.exec(a);){if(b.index!==e)throw new TypeError("invalid parameter format");if(e+=b[0].length,c=b[1].toLowerCase(),d=b[2],-1!==g.indexOf(c))throw new TypeError("invalid duplicate parameter");g.push(c),c.indexOf("*")+1!==c.length?"string"!=typeof h[c]&&('"'===d[0]&&(d=d.substr(1,d.length-2).replace(qescRegExp,"$1")),h[c]=d):(c=c.slice(0,-1),d=decodefield(d),h[c]=d)}if(-1!==e&&e!==a.length)throw new TypeError("invalid parameter format");return new ContentDisposition(f,h)}function pdecode(a,b){return String.fromCharCode(parseInt(b,16))}function pencode(a){var b=String(a).charCodeAt(0).toString(16).toUpperCase();return 1===b.length?"%0"+b:"%"+b}function qstring(a){var b=String(a);return'"'+b.replace(quoteRegExp,"\\$1")+'"'}function ustring(a){var b=String(a),c=encodeURIComponent(b).replace(encodeUriAttrCharRegExp,pencode);return"UTF-8''"+c}function ContentDisposition(a,b){this.type=a,this.parameters=b}module.exports=contentDisposition,module.exports.parse=parse;var basename=require("path").basename,encodeUriAttrCharRegExp=/[\x00-\x20"'\(\)*,\/:;<=>?@\[\\\]\{\}\x7f]/g,hexEscapeRegExp=/%[0-9A-Fa-f]{2}/,hexEscapeReplaceRegExp=/%([0-9A-Fa-f]{2})/g,nonLatin1RegExp=/[^\x20-\x7e\xa0-\xff]/g,qescRegExp=/\\([\u0000-\u007f])/g,quoteRegExp=/([\\"])/g,paramRegExp=/; *([!#$%&'\*\+\-\.0-9A-Z\^_`a-z\|~]+) *= *("(?:[ !\x23-\x5b\x5d-\x7e\x80-\xff]|\\[\x20-\x7e])*"|[!#$%&'\*\+\-\.0-9A-Z\^_`a-z\|~]+) */g,textRegExp=/^[\x20-\x7e\x80-\xff]+$/,tokenRegExp=/^[!#$%&'\*\+\-\.0-9A-Z\^_`a-z\|~]+$/,extValueRegExp=/^([A-Za-z0-9!#$%&+\-^_`{}~]+)'(?:[A-Za-z]{2,3}(?:-[A-Za-z]{3}){0,3}|[A-Za-z]{4,8}|)'((?:%[0-9A-Fa-f]{2}|[A-Za-z0-9!#$&+\-\.^_`|~])+)$/,dispositionTypeRegExp=/^([!#$%&'\*\+\-\.0-9A-Z\^_`a-z\|~]+) *(?:$|;)/;