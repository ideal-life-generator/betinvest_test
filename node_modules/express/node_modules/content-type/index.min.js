function format(a){if(!a||"object"!=typeof a)throw new TypeError("argument obj is required");var b=a.parameters,c=a.type;if(!c||!typeRegExp.test(c))throw new TypeError("invalid type");var d=c;if(b&&"object"==typeof b)for(var e,f=Object.keys(b).sort(),g=0;g<f.length;g++){if(e=f[g],!tokenRegExp.test(e))throw new TypeError("invalid parameter name");d+="; "+e+"="+qstring(b[e])}return d}function parse(a){if(!a)throw new TypeError("argument string is required");if("object"==typeof a&&(a=getcontenttype(a),"string"!=typeof a))throw new TypeError("content-type header is missing from object");if("string"!=typeof a)throw new TypeError("argument string is required to be a string");var b=a.indexOf(";"),c=-1!==b?a.substr(0,b).trim():a.trim();if(!typeRegExp.test(c))throw new TypeError("invalid media type");var d,e,f,g=new ContentType(c.toLowerCase());for(paramRegExp.lastIndex=b;e=paramRegExp.exec(a);){if(e.index!==b)throw new TypeError("invalid parameter format");b+=e[0].length,d=e[1].toLowerCase(),f=e[2],'"'===f[0]&&(f=f.substr(1,f.length-2).replace(qescRegExp,"$1")),g.parameters[d]=f}if(-1!==b&&b!==a.length)throw new TypeError("invalid parameter format");return g}function getcontenttype(a){return"function"==typeof a.getHeader?a.getHeader("content-type"):"object"==typeof a.headers?a.headers&&a.headers["content-type"]:void 0}function qstring(a){var b=String(a);if(tokenRegExp.test(b))return b;if(b.length>0&&!textRegExp.test(b))throw new TypeError("invalid parameter value");return'"'+b.replace(quoteRegExp,"\\$1")+'"'}function ContentType(a){this.parameters=Object.create(null),this.type=a}var paramRegExp=/; *([!#$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+) */g,textRegExp=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,tokenRegExp=/^[!#$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+$/,qescRegExp=/\\([\u000b\u0020-\u00ff])/g,quoteRegExp=/([\\"])/g,typeRegExp=/^[!#$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+\/[!#$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+$/;exports.format=format,exports.parse=parse;