function sha1(a){return crypto.createHash("sha1").update(a).digest("hex")}var crypto=require("crypto");exports.sign=function(a,b){if("string"!=typeof a)throw new TypeError("Cookie value must be provided as a string.");if("string"!=typeof b)throw new TypeError("Secret string must be provided.");return a+"."+crypto.createHmac("sha256",b).update(a).digest("base64").replace(/\=+$/,"")},exports.unsign=function(a,b){if("string"!=typeof a)throw new TypeError("Signed cookie string must be provided.");if("string"!=typeof b)throw new TypeError("Secret string must be provided.");var c=a.slice(0,a.lastIndexOf(".")),d=exports.sign(c,b);return sha1(d)==sha1(a)?c:!1};