function etag(a,b){if(null==a)throw new TypeError("argument entity is required");var c=isstats(a),d=b&&"boolean"==typeof b.weak?b.weak:c;if(c)return stattag(a,d);if("string"!=typeof a&&!Buffer.isBuffer(a))throw new TypeError("argument entity must be string, Buffer, or fs.Stats");var e=d?weakhash(a):stronghash(a);return d?'W/"'+e+'"':'"'+e+'"'}function isstats(a){return null===a||"object"!=typeof a?!1:a instanceof Stats?!0:"atime"in a&&"[object Date]"===toString.call(a.atime)&&"ctime"in a&&"[object Date]"===toString.call(a.ctime)&&"mtime"in a&&"[object Date]"===toString.call(a.mtime)&&"ino"in a&&"number"==typeof a.ino&&"size"in a&&"number"==typeof a.size}function stattag(a,b){var c=a.mtime.toISOString(),d=a.size.toString(16);if(b)return'W/"'+d+"-"+crc(c)+'"';var e=crypto.createHash("md5").update("file","utf8").update(NULL).update(d,"utf8").update(NULL).update(c,"utf8").digest("base64");return'"'+e+'"'}function stronghash(a){return 0===a.length?"1B2M2Y8AsgTpgAmY7PhCfg==":crypto.createHash("md5").update(a,"utf8").digest("base64")}function weakhash(a){if(0===a.length)return"0-0";var b="string"==typeof a?Buffer.byteLength(a,"utf8"):a.length;return crc32threshold>=b?b.toString(16)+"-"+crc(a).toString(16):crypto.createHash("md4").update(a,"utf8").digest("base64")}module.exports=etag;var crc=require("crc").crc32,crypto=require("crypto"),Stats=require("fs").Stats,crc32threshold=1e3,NULL=new Buffer([0]),toString=Object.prototype.toString;